<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

    <!-- Search Engine Optimization -->
    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>RPI Cluster | rpi_cluster</title>
<meta property="og:title" content="RPI Cluster" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cluster deployment the easy way" />
<meta property="og:description" content="Cluster deployment the easy way" />
<link rel="canonical" href="http://localhost:4000/rpi_cluster/" />
<meta property="og:url" content="http://localhost:4000/rpi_cluster/" />
<meta property="og:site_name" content="rpi_cluster" />
<script type="application/ld+json">
{"name":"rpi_cluster","description":"Cluster deployment the easy way","author":null,"@type":"WebSite","url":"http://localhost:4000/rpi_cluster/","publisher":null,"image":null,"headline":"RPI Cluster","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/rpi_cluster/assets/css/style.css?v=c43d0d0597914946637fbcc25c6b5838c30066ed">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/rpi_cluster/assets/css/main.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="/rpi_cluster/assets/css/font-awesome.min.css">
  </head>

  <body>

    <!-- Page header -->
    <section class="page-header">

      <!-- Headings -->
      <h1 class="project-name">rpi_cluster</h1>
      <h2 class="project-tagline">Cluster deployment the easy way</h2>
      
        <a href="http://github.com/N02870941/rpi_cluster" class="btn" target="_blank">View on GitHub</a>
      

      <!-- Download buttons -->
      
        <a href="https://github.com/N02870941/rpi_cluster/archive/master.zip" class="btn">Download .zip</a>
        <a href="https://github.com/N02870941/rpi_cluster/archive/master.tar.gz" class="btn">Download .tar.gz</a>
      
    </section>

    <!-- Main page content -->
    <section class="main-content">

      <!-- Back button -->
      <!-- Back button (Don't show on homepage) -->



      <!-- Main content -->
      <h1 id="rpi-cluster">RPI Cluster</h1>
<p>This is the documentation for the code I wrote to provision my
Raspberry Pi / Ubuntu cluster. This project is a proof of concept / peek
into the technical challenges of a system administrator. I wrote it because
I was interested in automating the process of provisioning different types
of servers and having them work together to as a functioning environment
for development and personal use. A diagram of my network architecture follows:</p>

<p><img src="/rpi_cluster/assets/img/cluster_diagram.png" alt="project architecture" /></p>

<h2 id="core-functionality">Core Functionality</h2>
<p>Provisioning a production quality network of servers is no trivial task. To keep the
codebase small and robust, I only focused on the core parts:</p>

<ul>
  <li>Network Attached Storage (NAS)</li>
  <li>Domain Name System (DNS)</li>
  <li>Network Address Translation (NAT)</li>
  <li>General purpose cluster</li>
</ul>

<p>Each of the above is deployed as a <a href="https://docs.docker.com/engine/swarm/">Docker Swarm</a> cluster, containing at least 1 node.
Deploying them as clusters allows for easily expansion and redundancy. Each server runs a an
instance of <a href="https://portainer.io/">Portainer</a> for container management from a web interace.</p>

<h2 id="auxiliary-functionality">Auxiliary Functionality</h2>
<p>To accomplish the core functionality, the following must be in place:</p>

<ul>
  <li>The ability to administer SSH keys for password-less SSH access</li>
  <li>IP address list generation to automatically discover nodes on the network.</li>
  <li>Hostname modification for labelling nodes based on their use</li>
</ul>

<h2 id="network-attached-storage-nas">Network Attached Storage (NAS)</h2>
<p>I accomplished NAS in two ways. First, I use <a href="https://www.samba.org/">Samba</a> to create network drives that can
be mounted as drives and used natively in any mainstream operating system. The second
approach was to expose a <a href="https://nextcloud.com/">Nextcloud</a> server for cloud storage. This provides a web
interface similar to Dropbox or Google Drive for content management. This also allows
several other devices on the network to connect with the desktop or mobile client app.</p>

<h2 id="domain-name-system-dns">Domain Name System (DNS)</h2>
<p>I use <a href="https://pi-hole.net/">Pi-hole</a> for DNS. This allows me to block unwanted ads at the network level. I can
also use Pi-hole to block traffic from specific sites and implement a DHCP server
for managing the DHCP leases of the other servers. Currently it is only being use for
itâ€™s DNS functionality.</p>

<h2 id="network-address-translation-nat">Network Address Translation (NAT)</h2>
<p>I use iptables and <a href="https://wiki.ubuntu.com/UncomplicatedFirewall">Uncomplicated Firewall (UFW)</a> for NAT. This allows me to expose
only one host (the firewall) that will forward traffic to the appropriate server
depending on port of the incoming connection. For example, port 80 might send traffic
to one of the general purpose servers, but port 53 goes to the DNS server.</p>

<h2 id="general-purpose-cluster">General purpose cluster</h2>
<p>The remaining servers are used as a general purpose cluster for deploying
web apps such as Wordpress or MySQL.</p>

<h2 id="other-links">Other links</h2>
<p>Check out the rest of the documentation.</p>

<ul>
  <li><a href="/rpi_cluster/pages/code.html">How the code works</a></li>
  <li><a href="/rpi_cluster/pages/install.html">Installation guide</a></li>
  <li><a href="/rpi_cluster/pages/reqs.html">System requirements</a></li>
  <li><a href="/rpi_cluster/pages/limits.html">Application limitations</a></li>
  <li><a href="/rpi_cluster/pages/demo.html">Project demo</a></li>
</ul>



      <!-- Site footer -->
      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/N02870941/rpi_cluster">rpi_cluster</a> is maintained by <a href="http://github.com/N02870941">N02870941</a>.</span>
        
      </footer>
    </section>

    <!-- Google Analytics -->
    
      <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    

    <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Fade in / out -->
    
<!-- TODO - Implement fade out -->
<script>


</script>


    <!-- Side navbar -->
    
<!--
  By default sidebar is hidden, that way,
  when we navigate to a page by the "Back()"
  event, the menu is not by default open.
 -->
<div id="sidebar" style="display:none;">

  <!--
    Invisiable checkbox, when checked,
    menu shows. This is accomplished at
    the CSS level using selectors
  -->
  <input type="checkbox" id="navigation" />
  <label for="navigation">
        <i class='fa fa-bars'></i>
  </label>

  <!-- List of options -->
  <nav id="menu">
    <ul>
      <li><a name="/rpi_cluster/" onclick="navigate_to_page(this.name)">Home</a></li>
      <li><a name="/rpi_cluster/pages/code.html" onclick="navigate_to_page(this.name)">Project Structure</a></li>
      <li><a name="/rpi_cluster/pages/install.html" onclick="navigate_to_page(this.name)">Installation Guide</a></li>
      <li><a name="/rpi_cluster/pages/reqs.html" onclick="navigate_to_page(this.name)">System Requirements</a></li>
      <li><a name="/rpi_cluster/pages/limits.html" onclick="navigate_to_page(this.name)">Application Limitations</a></li>
      <li><a name="/rpi_cluster/pages/demo.html" onclick="navigate_to_page(this.name)">Demo</a></li>
    </ul>
  </nav>
</div>

<script>

  // Hides the navbar menu
  let closeMenu = function() {
    $('#navigation').prop('checked', false);

    // Resolve promise after 250ms, gives
    // enough time for close animation to complete
    return new Promise(resolve => setTimeout(resolve, 250));
  }

  // By default the sidebare is hidden.
  // Make sure we uncheck the nav checkbox
  // so the menu is not out, then we can
  // show the sidebar (make it clickable)
  $(document).ready(function() {
      closeMenu();
      $('#sidebar').show();
  });

  // Close menu on Escape press
  $(document).keyup(function(e) {
     if (e.keyCode == 27) {
        closeMenu();
    }
  });

  // Close menu if click happens
  // outside of the sidebar
  $(document).mouseup(function(e) {
    let sidebar = $("#sidebar");

    // if the target of the click isn't the container
    // nor a descendant of the container, close the menue
    if (!sidebar.is(e.target) && sidebar.has(e.target).length === 0) {
        closeMenu();
    }
  });

  // Closes menu, then navigates to the href
  let navigate_to_page = async function(href) {
    await closeMenu();

    document.location.href = href;
  }
</script>


    <!-- Back to top button -->
    <div class='scrolltop'>
  <div class='scroll icon'>
    <i class='fa fa-4x fa-angle-up'></i>
  </div>
</div>

<script>
(function() {
    $(window).scroll(function() {
      if ($(this).scrollTop() > 50) {
          $('.scrolltop:hidden').stop(true, true).fadeIn();
      } else {
          $('.scrolltop').stop(true, true).fadeOut();
      }
    });
    $('.scroll').click(function() {
  		$('html, body').animate({
        scrollTop : 0},800);
  		return false;
  	});
})();
</script>

  </body>
</html>
